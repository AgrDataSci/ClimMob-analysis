**`r other_traits_list[[i]]$fullname`**


```{r}
x_tmp <- anovas[[i]]
if (length(x_tmp)>1) {
  p_tmp <- x_tmp[2,5]
  
  x_tmp[,6] <- stars.pval(x_tmp[, 5])
  x_tmp[,5] <- format.pval(x_tmp[, 5])
  names(x_tmp)[6] <- ""
  x_tmp[2, "model"] <- other_traits_list[[i]]$fullname

  kable(x_tmp,
        caption = paste0("Table 5.",i,".1"))
}

```

```{r}
message_tmp=""
if (length(x_tmp) > 1) {
if (p_tmp < 0.001) {
  message1 <- paste0("p=", format.pval(p_tmp), 
                    ". This suggests that there is strong evidence of ",
                    "a difference in the rankings between ",
                    options)
}

if (p_tmp < 0.01 & p_tmp > 0.001) {
  message1 <- paste0("p=", format.pval(p_tmp), 
                     ". This suggests that there is evidence of a difference between ",
                     options)
}
if (p_tmp > 0.01 & p_tmp < 0.05) {
  message1 <- paste0("p=", format.pval(p_tmp), 
                    ". This suggests that there is some evidence of a difference between ",
                    options)  
}
if (p_tmp > 0.05) {
  message1 <- paste0("p=", format.pval(p_tmp),
                    ". This suggests that there is not enough evidence to conclude that",
                    " there are differences between",
                    options)  
}
}
if(length(x_tmp) == 1){
  message_tmp <- "No statistical analysis was able to be conducted on this trait."
}
```

`r message_tmp`

```{r,fig.width=7,fig.height=7}

if(length(x_tmp)>1){

  plot.multcompPL(summaries[[i]], level = ci_level) +
    ggtitle(paste0("Preference estimates for ", tolower(other_traits_list[[i]]$fullname),
                   " with ", ci_level*100, "% confidence intervals"))
}
```

```{r}
if (length(x_tmp) > 1) {
  ms_i <- summaries[[i]]
  ms_i <- ms_i[, c("estimate","quasiSE",".group")]
  names(ms_i) <- c("Estimate","quasiSE","Group")
  
  kable(ms_i, digits = 2,
        caption = paste0(paste("Table 5.",i,".2 ",
                               other_traits_list[[i]]$fullname," model parameter estimates")))
}
```

```{r}
if (length(x_tmp) > 1) {


kable(worths[[i]][,-2],
      caption = paste0("Table 5.",i,".3 ","Probability of being highest ranked: ",
                      other_traits_list[[i]]$fullname))

dt_i <- worths[[i]]

ggplot(data=dt_i, aes(y = Worth, fill = Worth, group = dt_i[,1], x = 1)) +
  geom_bar(stat="identity",col="black", show.legend = FALSE) +
  theme_void() +
  geom_text(aes(y=cumsum(rev(Worth))-rev(Worth)/2, size=rev(Worth),
                label=rev(paste0(dt_i[,1],": ", round(Worth*100, 2),"%"))),
            show.legend = FALSE,fontface=2) +
  ggtitle(paste("Probability that",option,"is the\nhighest ranked for", 
                tolower(other_traits_list[[i]]$fullname))) +
  scale_fill_gradient2(low= "white", high = "forestgreen", midpoint= 1/nrow(worthscaled))  +
  scale_size_continuous(range=c(0.5,10),limits = c(0,1))

}
```
